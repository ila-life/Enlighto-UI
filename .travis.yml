os: linux
language: android
android:
  components:
  - tools
  - platform-tools
  - tools
  - build-tools-28.0.3
  - android-28
  - extra-google-google_play_services
  - extra-google-m2repository
  - extra-android-m2repository
  licenses:
  - android-sdk-preview-license-.+
  - android-sdk-license-.+
  - google-gdk-license-.+
addons:
  apt:
    sources:
    - sourceline: deb https://dl.yarnpkg.com/debian/ stable main
      key_url: https://dl.yarnpkg.com/debian/pubkey.gpg
    packages:
    - oracle-java8-installer
    - oracle-java8-set-default
before_install:
- export LANG=en_US.UTF-8
- nvm install 10.15.2
- npm install -g cordova ionic
- npm install
script:
- ionic cordova build android --release
- mkdir -p output
- cp platforms/android/app/build/outputs/apk/release/app-release-unsigned.apk output/ionictravis-release-unsigned.apk
env:
  global:
  - JAVA_HOME=/usr/lib/jvm/java-8-oracle
  - secure: i66GMvyQl286ztvqgTZ5HkD0v45ljRJzNzrpyG7PFjpyarEkr8zTyM82gEUToWjzXpRS9feuvOwhDkz1mY2B+XFt0iH6sXPB/JvSt9bV5LRXkFRwv49k+njhFnA1aae7tBsxxuybUqftACeUBdAycSKPEjODNwM1GyQB/cCduF/VqMJRjxzhaPTJa/uUUiBC4ekrKYJCU4cAM2YMdXt1J70usilB+s51McCB6tVmzNdkSKx+p7PEt1F6Fet9phKRRDDDNgJD9L4AD4HlydJwN+o+2oDdTOpP0yGBshfERZi2n1EhGGCt4dxhA9LPuVBObDiZBzRmh1/AYMZrLg7gSuaG4UjHvUbiH+ElFC1H+alw1EjOe59X9PJe/fqskHExr935e11OXQiKLv4wd/7TOPmj4dPKL4gEBxcHujRmT7dybm62DY9HisW6STTPyAArUnwSbIUP+m/4x03ICx+7yipcyNb6epPw4iwp7VPi7jcJaxx88phczZarR1hFGxdXDw+wGAhqIdlX+a8CEeFBvnnQszx8kLE4CFgjao0yNVTRAVd4q/O1uXn2LPzBpccNG/PHT+EDYQypH8ZeZ/LR5VgbeK1h3NP4GX/4PWrTBT0UH7EeJvIh/SuzS5tvPiEeE3rNFTNqsxtu+Tb7jDJ9Jk1QXXTgfY15iCOTwLwwlpY=
deploy:
  provider: releases
  api_key:
    secure: "<GITHUB_TOKEN>"
  file_glob: true
  file: output/*
  skip_cleanup: true
  overwrite: true
  on:
    branch: master
