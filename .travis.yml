os: linux
language: android
android:
  components:
  - platform-tools
  - tools
  - build-tools-28.0.3
  - android-28
  - extra-google-google_play_services
  - extra-google-m2repository
  - extra-android-m2repository
  - extra
  - add-on
  licenses:
  - android-sdk-preview-license-.+
  - android-sdk-license-.+
  - google-gdk-license-.+
addons:
  apt:
    sources:
    - sourceline: deb https://dl.yarnpkg.com/debian/ stable main
      key_url: https://dl.yarnpkg.com/debian/pubkey.gpg
    packages:
    - oracle-java8-installer
    - oracle-java8-set-default
before_install:
- openssl aes-256-cbc -K $encrypted_bd6e7088737f_key -iv $encrypted_bd6e7088737f_iv
  -in enlighto.jks.enc -out enlighto.jks -d
- export LANG=en_US.UTF-8
- nvm install 10.15.2
- npm install -g cordova ionic
- npm install
script:
- npm test
- ionic cordova build android --release
- mkdir -p output
- jarsigner -verbose -sigalg SHA1withRSA -storepass $storepass -keypass $keypass -digestalg
  SHA1 -keystore enlighto.jks platforms/android/app/build/outputs/apk/release/app-release-unsigned.apk
  enlighto
- "${ANDROID_HOME}/build-tools/28.0.3/zipalign -v 4 platforms/android/app/build/outputs/apk/release/app-release-unsigned.apk
  output/ionictravis-release-unsigned.apk"
env:
  global:
  - JAVA_HOME=/usr/lib/jvm/java-8-oracle
  - secure: Cbiw6L+qbNiZLAk00eQiffgDK4J6kVR0GIS4QKhWkjK3o514KZZp8E96nLt4aNTNP4tGr0b8RvpHyKaV+xEn8Y/nSc8CDOIFUS8JED/PvDkbYIEKoKupdIzcIv3+3oIiUJKMn0A1ZXGX5FthEsCPg8GVVK1J/0tchq4sLcHvf9BZ9CVSEGbLaaCJStnFPbFw6vqVFPjVKL6lU0QroqGAZPWBpRp6KbvO5vwyZzSdxGrK1eUxmY/RDZrue/zUquU9bYG9uYdQceBT9vCMPxH9gWU27nmLsVWkULcqPOOSZiUaoX2Lwm6a6Jp/gM6HkpgCw38mH+M98NAelFJXlExCRMaMryW71iRARC0ITo0pGtd7UQzlJX/YmqNVlravQosKly0oNWSfaRO5OGgtmLNoG2gqh2rIr/ortzuH1WRh71+dAaTe6yZwg0Bo135cqrqRgK2AbWYKNQbq8v6JsZWBJc/c2aWNXG+Xsbpo09TxGSEE515KeDNwEYQiYjOo3fV8XMZT+S4RDIu4/pNOeRD/C+WdYndgJOG0SziCwUff4pXmKebMTttq0Y0BR0odE51IeFw7nsFygtHTAd5GknIjeMw82qg3avfhtO2Z/cvC19Krt1xFz8FIdvctNk4nimUaJoUSfRFfNRL9SXz3/FwWNjJ8tgA0cN7KmRehFwGCRGM=
  - secure: DPow682xJ6rO1oN5/j114Qi1xGGrB7MPrn7vg6agMJAi2TuiJ7n4DJrvc+Xe7O6xsty8/3RBLjsuOT+5nghgdcgCWD5bPX+TKRq0Mf9VyBGeMWfTKRrRP1G+d54vM+SknSM5u71y3yrRavPUH2tGG1gdolBA9L+Z9zR4VDLjA9at4ffgPtWbSLqSZ3AYRX5NO6HCLttwfPJH/2CJxGo1ZKECCRtIvjtBO9538U7e3jTz6pOMH+La2k/JgCBd4Jo6QaT2Lh4B/5bw0Ti56zDd8Mp785hg3rT9u5XLzK96NRau5UYtFr08+kgur1kg4CVPjCuMgFzVPS2Uu9cJcUH4zc/pe9rVJtfjD5ifCro5mkpFhQwEGsUhI5RCbCFubz9a8Ye1Zxx4qOGLrf7oMA3fdGLsfSLSrcs2syJt0IEM8t0YAtc2v5RGMmYLk7KL2Hc7bnyHGpypzU/8ODTHoBTFACFxOaEjrXW8RxV4uuo4F0Rjl+hDEmQV/esgTVF4HQYeJ535TCnglGcmKRUNOdf//UNw8K44pKVCrWTtmIJjVzTC0PiPMi2OpiD0IA+kV6BOof/pYtuR/3N1j5K191/qHmmnIQ82AtV3DSnsIHNaLoIbWrzBB2REvLzYckT4MIAstPkydhhWfERdumiMtAybUX8Z13chacy0PvN0bHe8+TU=
deploy:
  provider: releases
  api_key:
    secure: XmPnSeo4sWPq+rwm2zYuXGWU97Ppn4cFG8sDADPUJXnqAb4JL4am1lg+po/e/Clm4MYsNblc1xSsxC1X821aizLiUSrVybg70WZXaJA2dxayRCFkJwlTHFWtdRhI4xV79u2R7lKrj3O+1VWcTb8X3HmxtyQ85IWYCUkrRZM7Ra9UKPIpgArrZ6gpEzFZxUpco17W+I4c02IvEkm6Z0+/N3PbNtQb417Ca1uxUPLcob8w4nBcHxUhUWoG5f7XyUM31xLt2ovrsSuIfvJbwymbembxPZ8d2XbRv7p4Uc7HbroDis2mmLCQOEYfb1kRPZ7n7GbHkzCsnGmz7Af35079yyPumjss+f72p8EeqeNXsny1r2XxDYHCTUmaIa+ORaHQY68VlvDskqiHtRhG8kk4pb9oc/hg0wyhIfjogrhKWw+aI5fma4U8665bCzWZa1OakHOcFlP1hcKfQ/jsQR5SzllDSrIqRxpUjokr1yC/K6k2O9AQUykorORfbR5mDfJTW5q1WfkaLObTyiuWqQqdIoykmaLNsL7PAXTmU5JhmNuPX9Mo1eVQwPPc71x5tDB//x1I1K4IhJq36QQhxL7KBj4IF3RhmtqW+/MaR3egN3fABTEC4PYZnbhm14q6uIwDce4oYxqoeFPqbBK2heJFIjck+N/YhogVXg4iJbAFgXc=
  file_glob: true
  file: output/*
  skip_cleanup: true
  overwrite: true
  on:
    branch: master
  draft: true
